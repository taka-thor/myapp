<div class="bg-[#f7f0e6] h-[90px] w-full flex items-center justify-between px-6 relative">
  <div>
    <% if @current_user.present? %>
      <div class="flex items-center gap-4">
        <% if @current_user.icon_url.present? %>
          <div class="w-[64px] h-[64px] rounded-full overflow-hidden bg-white shadow flex items-center justify-center">
            <%= image_tag @current_user.icon_url,
              alt: "#{@current_user.name || 'ユーザー'} さんのアイコン",
              class: "w-[85%] h-[85%] object-contain" %>
          </div>
        <% end %>

        <% if @current_user.name.present? %>
          <p class="text-black text-lg font-medium whitespace-nowrap">
            <%= @current_user.name %> さん
          </p>
        <% end %>
      </div>
    <% else %>
      <p class="text-[#4B4642] text-xl font-semibold">
        声友
      </p>
    <% end %>
  </div>

  <% if local_assigns.fetch(:show_menu, true) %>
    <details class="relative" data-header-menu>
      <summary
        class="list-none [&::-webkit-details-marker]:hidden cursor-pointer w-11 h-11 rounded-xl border border-slate-300 bg-white/80 flex items-center justify-center shadow-sm hover:bg-white"
        aria-label="メニュー"
      >
        <span class="flex flex-col gap-1.5">
          <span class="block w-5 h-0.5 bg-slate-700"></span>
          <span class="block w-5 h-0.5 bg-slate-700"></span>
          <span class="block w-5 h-0.5 bg-slate-700"></span>
        </span>
      </summary>

      <div class="absolute right-0 mt-2 w-52 rounded-xl border border-slate-200 bg-white shadow-lg z-50 overflow-hidden">
        <%= link_to "トップ", root_path, class: "block px-4 py-3 text-sm text-slate-800 hover:bg-slate-50" %>
        <%= link_to "ホーム", static_pages_home_path, class: "block px-4 py-3 text-sm text-slate-800 hover:bg-slate-50" %>
        <%= link_to "ユーザー情報", edit_user_path, class: "block px-4 py-3 text-sm text-slate-800 hover:bg-slate-50" %>
        <%= link_to "利用規約", terms_path, class: "block px-4 py-3 text-sm text-slate-800 hover:bg-slate-50" %>
        <%= link_to "プライバシーポリシー", privacy_policy_path, class: "block px-4 py-3 text-sm text-slate-800 hover:bg-slate-50" %>
        <%= link_to "お問い合わせ", contact_path, class: "block px-4 py-3 text-sm text-slate-800 hover:bg-slate-50" %>
        <div class="border-t border-slate-100">
          <button type="button"
                  data-howto-toggle
                  class="w-full flex items-center justify-between px-4 py-3 text-sm text-slate-800 hover:bg-slate-50">
            <span>ご利用方法</span>
            <span data-howto-arrow class="inline-block transition-transform" aria-hidden="true">▸</span>
          </button>

          <div data-howto-panel
              class="hidden bg-slate-50">
            <%= link_to "通話部屋について", how_to_talk_path,
                class: "block pl-8 pr-4 py-2 text-sm text-slate-700 hover:bg-slate-100" %>
          </div>
        </div>
      </div>
    </details>
  <% end %>
</div>

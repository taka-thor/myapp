<div id="room_<%= room.id %>_participants">
  <div class="grid grid-cols-2 gap-x-6 gap-y-8 sm:gap-x-8 sm:gap-y-10">
    <% room.active_users.limit(4).each do |user| %>
      <% is_current_user = (@current_user&.id == user.id) %>
      <div class="flex flex-col items-center gap-2">
        <div
          class="rtc-avatar-ring rounded-full p-1 transition"
          data-rtc-user-id="<%= user.id %>"
        >
          <div class="relative w-24 h-24 sm:w-28 sm:h-28 rounded-full overflow-hidden bg-slate-100 shadow-sm flex items-center justify-center">
            <% if user.respond_to?(:icon_url) && user.icon_url.present? %>
              <%= image_tag user.icon_url, alt: user.name, class: "w-[85%] h-[85%] object-contain" %>
            <% else %>
              <div class="w-full h-full flex items-center justify-center text-3xl sm:text-4xl">
                üêæ
              </div>
            <% end %>
          </div>
        </div>

        <div class="max-w-[10rem]">
          <p class="flex items-center justify-center gap-1 text-sm sm:text-base font-medium text-slate-900">
            <span class="truncate max-w-[8rem] text-center"><%= user.name %></span>

            <span
              class="inline-flex h-5 w-5 items-center justify-center text-sky-500 transition"
              data-rtc-speaker-status
              data-rtc-user-id="<%= user.id %>"
              aria-label="Ëá™ÂàÜ„ÅÆÈü≥Â£∞ ON"
              role="img"
            >
              <svg
                data-rtc-speaker-on-icon
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                class="h-5 w-5"
                aria-hidden="true"
              >
                <path stroke-linecap="round" stroke-linejoin="round" d="M11.25 5.25L6 9.75H3.75v4.5H6l5.25 4.5V5.25z" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 8.25a4.5 4.5 0 010 7.5" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M18.75 6a8.25 8.25 0 010 12" />
              </svg>

              <svg
                data-rtc-speaker-off-icon
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                class="hidden h-5 w-5"
                aria-hidden="true"
              >
                <path stroke-linecap="round" stroke-linejoin="round" d="M11.25 5.25L6 9.75H3.75v4.5H6l5.25 4.5V5.25z" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M14.25 9.75l6 6" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 9.75l-6 6" />
              </svg>
            </span>
          </p>

          <% if is_current_user %>
            <button
              type="button"
              data-rtc-mute-toggle
              data-rtc-user-id="<%= user.id %>"
              aria-pressed="false"
              class="mt-2 w-full rounded-full px-3 py-1.5 text-xs sm:text-sm font-semibold transition bg-emerald-500 text-white hover:opacity-90 active:scale-95"
            >
              Ëá™ÂàÜ„ÅÆÈü≥Â£∞ ON
            </button>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>

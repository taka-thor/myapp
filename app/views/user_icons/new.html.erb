<% content_for(:title, t('.title')) %>
<%# <style>
  * { outline: 1px solid red; }
</style> %>
<div class="min-h-screen flex flex-col" data-controller="user-icon">
  <!-- タイトル -->
  <header class="px-6 pt-6 pb-4">
    <h1 class="text-[26px] font-semibold text-center text-[#4B4642]">アイコンを選んでください</h1>
  </header>

  <!-- アイコン一覧 -->
  <main class="flex-1 overflow-y-auto pt-1 px-6 pb-28">
    <div class="grid grid-cols-4 gap-4 justify-items-center">
      <% @icons.each do |icon| %>
        <button
          type="button"
          class="icon-option relative rounded-full p-[3px] transition ring-0 focus:outline-none"
          data-icon-id="<%= icon %>"
          data-user-icon-target="option"
        >
          <div
            class="w-[74px] h-[74px] rounded-full overflow-hidden bg-slate-100 flex items-center justify-center"
          >
            <img
              src="<%= icon %>"
              alt="アイコン"
              class="w-[85%] h-[85%] object-contain"
            />
          </div>
        </button>
      <% end %>
    </div>
  </main>

  <!-- 決定ボタン（最初は非表示） -->
  <%= form_with(
        model: @user,
        url: user_icons_path,
        data: { turbo_method: :post, user_icon_target: "form" },
        id: "icon-form",
        class: "fixed bottom-0 left-0 right-0 pb-6 pointer-events-none flex justify-center"
      ) do %>
    <input type="hidden" name="user[icon_url]" id="selected-icon-id" data-user-icon-target="input" />
    <button
      type="submit"
      id="icon-submit"
      data-user-icon-target="submit"
      class="w-[40vw] max-w-[425px] mx-auto py-3 rounded-xl bg-sky-500 text-white font-semibold shadow-lg opacity-0 translate-y-4 transition pointer-events-none"
    >
      決定
    </button>
  <% end %>
</div>
